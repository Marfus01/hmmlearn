根据以下结果，解码准确率较低，主要是因为 HMM 过于强调连续性。可能需要根据后验概率筛选高置信度的解码，用于修正观测，而非直接将解码序列作为最终结果。


(base) wangchen@wangchendeMacBook-Pro hmmlearn % /opt/homebrew/Caskroom/miniforge/base/bin/python /Users/wangchen/research/hmmlearn/debug/tv_data_sim.py
=== 数据格式验证 ===
X_1 shape: (90, 3) (说话人标签, one-hot)
X_2 shape: (90, 3) (面部出现)
lengths: [15, 20, 12, 25, 18]

=== 训练模型 ===
         1    -273.20916447             +nan
         2    -256.15825049     +17.05091398
         3    -253.39501040      +2.76324009
         4    -250.25400491      +3.14100549
         5    -246.60908278      +3.64492214
         6    -242.86049007      +3.74859271
         7    -239.88285021      +2.97763986
         8    -238.03854768      +1.84430253
         9    -236.91181868      +1.12672900
        10    -236.09364809      +0.81817059
        11    -235.43947681      +0.65417128
        12    -234.89868983      +0.54078698
        13    -234.43172714      +0.46696269
        14    -233.99984068      +0.43188646
        15    -233.56866207      +0.43117861
        16    -233.11330420      +0.45535787
        17    -232.62783273      +0.48547147
        18    -232.13252042      +0.49531231
        19    -231.66519500      +0.46732541
        20    -231.25906390      +0.40613110
        21    -230.93123119      +0.32783271
        22    -230.68334976      +0.24788143
        23    -230.50478244      +0.17856732
        24    -230.37889909      +0.12588335
        25    -230.28955697      +0.08934212
        26    -230.22501024      +0.06454673
        27    -230.17734556      +0.04766469
        28    -230.14155538      +0.03579018
        29    -230.11423763      +0.02731775
        30    -230.09300145      +0.02123618
        31    -230.07618542      +0.01681603
        32    -230.06283428      +0.01335114
        33    -230.05170976      +0.01112452
        34    -230.04220837      +0.00950139
        35    -230.03361646      +0.00859191
        36    -230.02636286      +0.00725360
        37    -230.01987086      +0.00649200
        38    -230.01399642      +0.00587443
        39    -230.00863308      +0.00536334
        40    -230.00370047      +0.00493261
        41    -229.99913523      +0.00456524
        42    -229.99488744      +0.00424779
        43    -229.99092876      +0.00395867
        44    -229.98721927      +0.00370949
        45    -229.98373258      +0.00348670
        46    -229.98044679      +0.00328578
        47    -229.97734296      +0.00310383
        48    -229.97440475      +0.00293820
        49    -229.97161795      +0.00278680
        50    -229.96897016      +0.00264778
        51    -229.96645044      +0.00251972
        52    -229.96404898      +0.00240146
        53    -229.96175713      +0.00229185
        54    -229.95956711      +0.00219002
        55    -229.95747198      +0.00209513
        56    -229.95546553      +0.00200645
        57    -229.95354207      +0.00192346
        58    -229.95169644      +0.00184563
        59    -229.94992401      +0.00177243
        60    -229.94822057      +0.00170344
        61    -229.94658232      +0.00163825
        62    -229.94500561      +0.00157671
        63    -229.94348734      +0.00151827
        64    -229.94202452      +0.00146282
        65    -229.94061441      +0.00141011
        66    -229.93925447      +0.00135994
        67    -229.93794237      +0.00131211
        68    -229.93667603      +0.00126633
        69    -229.93545345      +0.00122258
        70    -229.93427272      +0.00118073
        71    -229.93313209      +0.00114063
        72    -229.93202996      +0.00110213
        73    -229.93096487      +0.00106510
        74    -229.92993538      +0.00102948
        75    -229.92893998      +0.00099540

=== 学习到的参数对比 ===
α (面部出现初始概率):
真实: [0.3 0.5 0.2]
学习: [0.775 0.822 0.323]

β (说话人初始偏好):
真实: [0.1  0.2  0.15]
学习: [  4.03   15.881 -21.23 ]

γ1 (面部对说话人初始影响):
真实: 2.0
学习: [-23.823]

γ2 (面部对说话人转移影响):
真实: 1.5
学习: [18.091]

A_F (面部转移矩阵):
演员0 真实: [[0.8 0.2]
 [0.3 0.7]]
演员0 学习: [[1.    0.   ]
 [0.085 0.915]]
演员1 真实: [[0.7  0.3 ]
 [0.25 0.75]]
演员1 学习: [[0.798 0.202]
 [0.14  0.86 ]]
演员2 真实: [[0.85 0.15]
 [0.4  0.6 ]]
演员2 学习: [[0.798 0.202]
 [0.593 0.407]]

A_S (说话人转移矩阵):
真实: [[0.6  0.25 0.15]
 [0.1  0.7  0.2 ]
 [0.3  0.2  0.5 ]]
学习: [[ -3.049  -8.09   11.023]
 [  3.807   2.986  -6.728]
 [  7.841 -11.415   4.734]]

B_F (面部识别混淆矩阵):
演员0 真实: [[0.9  0.1 ]
 [0.15 0.85]]
演员0 学习: [[0.787 0.213]
 [0.278 0.722]]
演员1 真实: [[0.85 0.15]
 [0.2  0.8 ]]
演员1 学习: [[0.96  0.04 ]
 [0.139 0.861]]
演员2 真实: [[0.88 0.12]
 [0.18 0.82]]
演员2 学习: [[0.892 0.108]
 [0.452 0.548]]

B_S (说话人识别混淆矩阵):
真实: [[0.8  0.15 0.05]
 [0.1  0.85 0.05]
 [0.1  0.1  0.8 ]]
学习: [[0.578 0.422 0.   ]
 [0.066 0.878 0.056]
 [0.063 0.008 0.929]]

=== 计算后验概率 ===
后验概率形状: 
(90, 3)
(90, 3)
(90, 8, 3)

=== MAP 解码结果 ===

--- 面部状态对比 (MAP) ---
真实状态 -> 观测状态 -> MAP推断状态 (转置显示，每列为一个时间步)

演员 0:
真实: [0 1 0 0 0 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 0 0 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 1 0 1 1 1 0 1 0 0 0 0 0 1 0 0 0 0 0 0 1
 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
观测: [0 1 0 1 0 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1
 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 0 0 1 0 1 0 1 1 1 1 0 0 0 0 1 0 0 0 0 0 0 1
 1 1 1 0 0 0 0 1 1 0 1 0 0 0 0 0]
MAP:  [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]

演员 1:
真实: [0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 0 0 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 1 1 1 0 0 0 1 0 0 0 0 0 0 0 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
观测: [0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 0 0 1 1 1 0 1 0 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 1 1 1 1 1
 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0]
MAP:  [0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]

演员 2:
真实: [0 0 0 1 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1
 1 1 0 0 0 0 0 1 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 1 0 1 0 0 0 0 0 0 0
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
观测: [0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 1 0 0 0 1 0 1
 0 1 0 0 0 0 0 1 0 0 1 1 1 1 1 0 0 1 0 0 1 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0
 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]
MAP:  [0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 1 0 1
 1 1 0 0 0 0 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0
 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]

--- 说话人状态对比 (MAP) ---
真实状态 -> 观测状态 -> MAP推断状态
真实: [1 0 1 2 0 2 2 2 2 1 2 0 0 0 1 0 0 2 2 1 1 1 1 1 1 0 2 2 2 0 0 1 2 2 2 0 0
 0 0 0 0 0 0 2 2 0 0 1 1 2 0 1 0 1 0 0 0 1 1 1 2 1 1 2 1 2 0 2 0 2 1 2 1 1
 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1]
观测: [1 0 1 2 0 2 1 2 2 1 2 1 0 1 1 0 2 1 2 1 1 1 1 1 1 1 2 2 2 0 0 1 2 2 2 1 0
 2 1 0 0 0 0 0 2 0 0 1 1 2 1 1 0 0 0 0 0 1 1 0 2 1 1 2 1 2 0 2 0 2 1 2 1 1
 0 2 0 1 1 1 1 1 0 1 1 1 1 2 1 1]
MAP:  [1 0 0 2 0 2 0 2 2 0 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 2 2 2 0 2 0 2 2 2 1 0
 2 0 0 0 0 0 0 2 0 0 1 0 2 0 0 0 0 0 0 0 0 0 0 2 0 1 2 0 2 0 2 0 2 0 2 1 1
 0 2 0 1 1 1 1 1 1 1 1 1 1 1 1 1]

=== Viterbi 解码结果 ===

--- 面部状态对比 (Viterbi) ---
真实状态 -> 观测状态 -> Viterbi推断状态 (转置显示，每列为一个时间步)

演员 0:
真实: [0 1 0 0 0 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 0 0 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 1 0 1 1 1 0 1 0 0 0 0 0 1 0 0 0 0 0 0 1
 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
观测: [0 1 0 1 0 0 0 1 1 0 0 1 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1
 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 0 0 1 0 1 0 1 1 1 1 0 0 0 0 1 0 0 0 0 0 0 1
 1 1 1 0 0 0 0 1 1 0 1 0 0 0 0 0]
Viterbi: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1
 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]

演员 1:
真实: [0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 0 0 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 1 1 1 0 0 0 1 0 0 0 0 0 0 0 1 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
观测: [0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 0 0 1 1 1 0 1 0 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 1 1 1 1 1
 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0]
Viterbi: [0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1 1
 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]

演员 2:
真实: [0 0 0 1 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1
 1 1 0 0 0 0 0 1 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 1 1 0 1 0 0 0 0 0 0 0
 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
观测: [0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 1 0 0 0 1 0 1
 0 1 0 0 0 0 0 1 0 0 1 1 1 1 1 0 0 1 0 0 1 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0
 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]
Viterbi: [0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1 0 0 1 1 0 1
 1 1 0 0 0 0 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0
 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]

--- 说话人状态对比 (Viterbi) ---
真实状态 -> 观测状态 -> Viterbi推断状态
真实: [1 0 1 2 0 2 2 2 2 1 2 0 0 0 1 0 0 2 2 1 1 1 1 1 1 0 2 2 2 0 0 1 2 2 2 0 0
 0 0 0 0 0 0 2 2 0 0 1 1 2 0 1 0 1 0 0 0 1 1 1 2 1 1 2 1 2 0 2 0 2 1 2 1 1
 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1]
观测: [1 0 1 2 0 2 1 2 2 1 2 1 0 1 1 0 2 1 2 1 1 1 1 1 1 1 2 2 2 0 0 1 2 2 2 1 0
 2 1 0 0 0 0 0 2 0 0 1 1 2 1 1 0 0 0 0 0 1 1 0 2 1 1 2 1 2 0 2 0 2 1 2 1 1
 0 2 0 1 1 1 1 1 0 1 1 1 1 2 1 1]
Viterbi: [1 0 0 2 0 2 0 2 2 0 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 2 2 2 0 2 0 2 2 2 1 0
 2 0 0 0 0 0 0 2 0 0 1 0 2 0 0 0 0 0 0 0 0 0 0 2 0 1 2 0 2 0 2 0 2 0 2 1 1
 0 2 0 1 1 1 1 1 1 1 1 1 1 1 1 1]

=== 准确率统计 ===

=== 准确率分析 ===
面部状态准确率:
  观测准确率: 0.844
  MAP准确率:  0.833
  Viterbi准确率: 0.833
说话人状态准确率:
  观测准确率: 0.822
  MAP准确率:  0.700
  Viterbi准确率: 0.700